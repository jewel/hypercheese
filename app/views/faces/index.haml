%h1 Faces
%p
  There are
  = Face.joins(:item).merge(Item.can_be_shown_everywhere).count
  faces,
  = Face.joins(:item).merge(Item.can_be_shown_everywhere).where.not(tag_id: nil).count
  canonical faces,
  = Face.joins(:item).merge(Item.can_be_shown_everywhere).where.not(cluster_id: nil).count
  clustered faces, and
  %a(href="/faces/unclustered")
    = Face.joins(:item).merge(Item.can_be_shown_everywhere).where(cluster_id: nil).count
  unclustered faces.
.face-list
  - @tags.each do |tag|
    .face
      - faces = tag.faces.joins(:item).merge(Item.can_be_shown_everywhere).includes(:item).to_a.sort_by { _1.item.taken }.reverse
      - faces.each do |face|
        %a(href="/faces/#{face.id}")
          %img{ src: face.url }
      %br
      %strong= tag.label
      %br
      = pluralize tag.total_items || 0, 'item'
      %br
      = pluralize tag.total_faces || 0, 'face'
